<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
<meta name="theme-color" content="#020704">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>নামাজের ওয়াক্ত</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="shortcut icon" href="mosque.png" type="image/x-icon">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Aref+Ruqaa+Ink:wght@400;700&family=Scheherazade+New:wght@400;500;600;700&family=Noto+Naskh+Arabic:wght@400;500;600;700&family=Tiro+Bangla:ital@0;1&family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
/* ══════════════════════════════════════════════════
   DESIGN TOKENS
══════════════════════════════════════════════════ */
:root{
  --void:#010402; --abyss:#030906; --deep:#050e07; --forest:#071209; --canopy:#0a1c0d;
  --jade:#0e5c38; --jade2:#117a4a; --jade3:#159c5e; --jade4:#1abf72;
  --Au1:#8a6010; --Au2:#b8921e; --Au3:#d4a832; --Au4:#e8bf50;
  --Au5:#f5d870; --Au6:#fdeea0; --Au7:#fff8d0;
  --ink:#faf4e4; --vellum:#f0e6c8; --faded:#c8bea0; --mist:#6a7860; --ash:#3e4a38;
  --card:rgba(7,18,9,.88); --card2:rgba(10,24,12,.93); --card3:rgba(13,32,16,.96);
  --rim0:rgba(184,146,30,.10); --rim1:rgba(184,146,30,.22);
  --rim2:rgba(184,146,30,.42); --rim3:rgba(184,146,30,.68);
  --sh1:0 4px 20px rgba(0,0,0,.55); --sh2:0 10px 44px rgba(0,0,0,.70);
  --r3:24px; --r2:16px; --r1:12px; --r0:8px;
}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
html{height:100%;-webkit-text-size-adjust:100%;}
body{
  font-family:'Tiro Bangla','Hind Siliguri',sans-serif;
  background:var(--void); color:var(--vellum);
  min-height:100vh;min-height:100dvh;
  overflow-x:hidden;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* ══════════════════════════════════════════════════
   BACKGROUND — 6 layered atmosphere
══════════════════════════════════════════════════ */
.bg-atmo{
  position:fixed;inset:0;z-index:0;pointer-events:none;
  background:
    radial-gradient(ellipse 180% 65% at 50% -5%, rgba(14,92,56,.60) 0%,transparent 58%),
    radial-gradient(ellipse 90%  55% at 95% 105%,rgba(14,92,56,.22) 0%,transparent 52%),
    radial-gradient(ellipse 60%  45% at 0%   65%, rgba(14,92,56,.14) 0%,transparent 48%),
    radial-gradient(ellipse 40%  30% at 50%  50%, rgba(14,92,56,.06) 0%,transparent 70%),
    linear-gradient(175deg,#040c06 0%,#020704 50%,#010402 100%);
}
.bg-geo{
  position:fixed;inset:0;z-index:0;pointer-events:none;opacity:.062;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cdefs%3E%3Cstyle%3E.g%7Bfill:none;stroke:%23d4a832;%7D%3C/style%3E%3C/defs%3E%3Cg class='g'%3E%3Cpolygon points='110,10 124,50 164,50 132,74 144,114 110,90 76,114 88,74 56,50 96,50' stroke-width='1'/%3E%3Cpolygon points='110,28 120,56 150,56 128,72 136,100 110,84 84,100 92,72 70,56 100,56' stroke-width='0.5'/%3E%3Ccircle cx='110' cy='110' r='68' stroke-width='.45'/%3E%3Ccircle cx='110' cy='110' r='45' stroke-width='.3'/%3E%3Ccircle cx='110' cy='110' r='22' stroke-width='.22'/%3E%3Cline x1='110' y1='5' x2='110' y2='215' stroke-width='.22' stroke-dasharray='3,11'/%3E%3Cline x1='5' y1='110' x2='215' y2='110' stroke-width='.22' stroke-dasharray='3,11'/%3E%3Cline x1='26' y1='26' x2='194' y2='194' stroke-width='.18' stroke-dasharray='2,14'/%3E%3Cline x1='194' y1='26' x2='26' y2='194' stroke-width='.18' stroke-dasharray='2,14'/%3E%3C/g%3E%3C/svg%3E");
  background-size:220px 220px;
}
.bg-cali{position:fixed;inset:0;z-index:0;pointer-events:none;display:flex;align-items:center;justify-content:center;overflow:hidden;}
.bg-cali-text{
  font-family:'Aref Ruqaa Ink',serif;
  font-size:clamp(5rem,28vw,14rem);
  color:rgba(184,146,30,.030);
  white-space:nowrap;line-height:1;letter-spacing:.05em;user-select:none;
  transform:rotate(-12deg) translateY(-5%);
  text-shadow:0 0 80px rgba(184,146,30,.04);
}
.bg-cali2{
  position:fixed;bottom:-4%;right:-8%;z-index:0;pointer-events:none;
  font-family:'Noto Naskh Arabic',serif;
  font-size:clamp(4rem,22vw,11rem);
  color:rgba(184,146,30,.022);
  line-height:1;user-select:none;transform:rotate(8deg);
}
.bg-vig{
  position:fixed;inset:0;z-index:0;pointer-events:none;
  background:radial-gradient(ellipse 100% 100% at 50% 50%,transparent 35%,rgba(1,4,2,.55) 100%);
}

/* ══════════════════════════════════════════════════
   FLOATING PARTICLES — spark dust only (mobile-safe)
   Only opacity animations — zero transform cost
══════════════════════════════════════════════════ */
.dust{position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden;}

/* Only class kept: tiny spark dust — pure opacity fade, no movement */
.mote-star{
  position:absolute;
  width:2px;height:2px;border-radius:50%;
  background:rgba(253,238,160,.90);
  will-change:opacity;
  animation:sparkFade ease-in-out infinite;
}
@keyframes sparkFade{
  0%,100%{opacity:0;}
  50%    {opacity:1;}
}

/* Mobile override: remove streaks/orbs/glows entirely */
@media(max-width:600px){
  .mote,.mote-streak,.mote-glow,.mote-poly,.mote-crescent{ display:none!important; }
}

/* ══════════════════════════════════════════════════
   CROWN
══════════════════════════════════════════════════ */
.crown{position:fixed;top:0;left:0;right:0;z-index:500;pointer-events:none;}
.crown-top{
  height:2px;
  background:linear-gradient(90deg,transparent 0%,var(--Au2) 15%,var(--Au5) 35%,var(--Au7) 50%,var(--Au5) 65%,var(--Au2) 85%,transparent 100%);
  animation:crownPulse 4s ease-in-out infinite;
}
.crown-glow{height:18px;background:linear-gradient(180deg,rgba(212,168,50,.18) 0%,transparent 100%);}
@keyframes crownPulse{0%,100%{opacity:.28;}50%{opacity:1;}}

/* ══════════════════════════════════════════════════
   ROOT
══════════════════════════════════════════════════ */
.root{
  position:relative;z-index:1;
  max-width:440px;margin:0 auto;
  padding:0 13px calc(env(safe-area-inset-bottom,0px) + 36px);
}

/* ══════════════════════════════════════════════════
   HERO
══════════════════════════════════════════════════ */
.hero{text-align:center;padding:52px 8px 20px;position:relative;}
.halo{position:relative;width:110px;height:110px;margin:0 auto 4px;}
.halo::before{
  content:'';position:absolute;inset:-8px;border-radius:50%;
  background:conic-gradient(from 0deg,transparent 0%,rgba(212,168,50,.12) 20%,rgba(245,216,112,.28) 50%,rgba(212,168,50,.12) 80%,transparent 100%);
  will-change:transform;
  animation:haloSpin 12s linear infinite;
}
.halo::after{
  content:'';position:absolute;inset:4px;border-radius:50%;
  border:1px solid rgba(212,168,50,.2);
  box-shadow:0 0 30px rgba(212,168,50,.15),inset 0 0 20px rgba(212,168,50,.08);
}
@keyframes haloSpin{from{transform:rotate(0deg);}to{transform:rotate(360deg);}}
.dome-svg{
  width:88px;height:88px;display:block;margin:0 auto;position:relative;z-index:1;
  filter:drop-shadow(0 0 24px rgba(212,168,50,.70)) drop-shadow(0 0 60px rgba(212,168,50,.30)) drop-shadow(0 6px 12px rgba(0,0,0,.60));
  will-change:transform;
  animation:domeLevitate 7s ease-in-out infinite;
}
@keyframes domeLevitate{0%,100%{transform:translateY(0) rotate(0);}33%{transform:translateY(-11px) rotate(.7deg);}66%{transform:translateY(-5px) rotate(-.4deg);}}
.basmala{
  font-family:'Aref Ruqaa Ink',serif;
  font-size:clamp(1.55rem,7.5vw,2.3rem);color:var(--Au5);
  display:block;margin:18px 4px 16px;line-height:1.65;letter-spacing:4px;
  text-shadow:0 0 35px rgba(245,216,112,.65),0 0 70px rgba(212,168,50,.25),0 3px 6px rgba(0,0,0,.90);
  animation:basmalaBreath 5s ease-in-out infinite;
}
@keyframes basmalaBreath{0%,100%{text-shadow:0 0 28px rgba(245,216,112,.50),0 3px 6px rgba(0,0,0,.9);}50%{text-shadow:0 0 55px rgba(245,216,112,.90),0 0 100px rgba(212,168,50,.30),0 3px 6px rgba(0,0,0,.9);}}
.mosque-name{
  font-family:'Tiro Bangla',serif;font-size:clamp(1.7rem,8.5vw,2.8rem);font-weight:400;
  background:linear-gradient(160deg,var(--Au6) 0%,var(--Au4) 45%,var(--Au5) 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  line-height:1.25;letter-spacing:.8px;
  filter:drop-shadow(0 2px 16px rgba(212,168,50,.35));
  animation:nameShimmer 6s ease-in-out infinite, heroEntryName .9s cubic-bezier(.22,1,.36,1) .3s both;
}
@keyframes heroEntryName{from{opacity:0;transform:translateY(22px) scale(.97);}to{opacity:1;transform:none;}}
@keyframes nameShimmer{0%,100%{filter:drop-shadow(0 2px 12px rgba(212,168,50,.25));}50%{filter:drop-shadow(0 2px 28px rgba(212,168,50,.60));}}
.orn{display:flex;align-items:center;justify-content:center;gap:6px;margin:14px auto 0;max-width:280px;}
.orn-l{flex:1;height:1px;background:linear-gradient(90deg,transparent,var(--Au3),transparent);}
.orn-d{width:7px;height:7px;background:var(--Au4);transform:rotate(45deg);box-shadow:0 0 10px var(--Au4),0 0 20px rgba(212,168,50,.4);flex-shrink:0;}
.orn-dot{color:var(--Au5);font-size:.78rem;line-height:1;}

/* ══════════════════════════════════════════════════
   TABS
══════════════════════════════════════════════════ */
.tab-rail{
  position:sticky;top:0;z-index:200;padding:11px 0 9px;
  background:linear-gradient(180deg,rgba(1,4,2,.98) 0%,rgba(1,4,2,.85) 100%);
  backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);
}
.tab-bar{
  display:grid;grid-template-columns:1fr 1fr;
  background:rgba(5,14,7,.92);border:1px solid var(--rim1);border-radius:100px;
  padding:4px;gap:4px;
  box-shadow:var(--sh1),inset 0 1px 0 rgba(212,168,50,.12),inset 0 -1px 0 rgba(0,0,0,.3);
}
.t-btn{
  padding:13px 4px;border:none;background:transparent;border-radius:100px;
  font-family:'Tiro Bangla',serif;font-size:clamp(.84rem,4.2vw,1.05rem);font-weight:400;
  color:var(--mist);cursor:pointer;transition:all .35s cubic-bezier(.4,0,.2,1);
  -webkit-tap-highlight-color:transparent;touch-action:manipulation;
  white-space:nowrap;letter-spacing:.4px;position:relative;overflow:hidden;
}
.t-btn::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.08),transparent);transform:translateX(-100%);transition:transform .5s ease;}
.t-btn.on::after{transform:translateX(100%);}
.t-btn.on{
  background:linear-gradient(145deg,var(--jade) 0%,var(--jade2) 60%,var(--jade3) 100%);
  color:var(--Au5);font-weight:400;
  box-shadow:0 4px 20px rgba(14,92,56,.55),0 0 0 1px rgba(212,168,50,.38),inset 0 1px 0 rgba(255,255,255,.14),inset 0 -1px 0 rgba(0,0,0,.2);
  text-shadow:0 1px 8px rgba(0,0,0,.5);
}

/* ══════════════════════════════════════════════════
   PANELS
══════════════════════════════════════════════════ */
.panel{display:none;}
.panel.on{display:block;animation:panelReveal .42s cubic-bezier(.22,1,.36,1) both;}
@keyframes panelReveal{from{opacity:0;transform:translateY(26px) scale(.98);}to{opacity:1;transform:none;}}

.live-dot{
  display:flex;align-items:center;justify-content:center;gap:6px;padding:5px 0 10px;
  font-family:'Hind Siliguri',sans-serif;font-size:.64rem;font-weight:700;
  letter-spacing:1.2px;text-transform:uppercase;color:var(--ash);
}
.live-dot .dot{width:6px;height:6px;border-radius:50%;background:var(--ash);flex-shrink:0;transition:background .4s,box-shadow .4s;}
.live-dot.live{color:rgba(80,220,140,.9);}
.live-dot.live .dot{background:#50dc8c;box-shadow:0 0 8px #50dc8c,0 0 16px rgba(80,220,140,.5);animation:livePulse 1.1s ease-in-out infinite alternate;}
@keyframes livePulse{from{opacity:1;}to{opacity:.3;}}

/* ══════════════════════════════════════════════════
   DATE BANNER
══════════════════════════════════════════════════ */
.date-banner{
  position:relative;background:var(--card2);border:1px solid var(--rim1);border-radius:var(--r3);
  margin-bottom:12px;overflow:hidden;
  box-shadow:var(--sh2),inset 0 1px 0 rgba(212,168,50,.10);
  display:grid;grid-template-columns:1fr 1px 1fr;
}
.date-banner::before{content:'✦';position:absolute;top:6px;left:10px;color:rgba(212,168,50,.25);font-size:.65rem;pointer-events:none;}
.date-banner::after {content:'✦';position:absolute;bottom:6px;right:10px;color:rgba(212,168,50,.25);font-size:.65rem;pointer-events:none;}
.date-banner-inner{position:absolute;inset:0;pointer-events:none;background:linear-gradient(110deg,transparent 30%,rgba(212,168,50,.03) 50%,transparent 70%);animation:bannerSweep 8s ease-in-out infinite;}
@keyframes bannerSweep{0%{transform:translateX(-100%);}55%,100%{transform:translateX(100%);}}
.date-col{padding:15px 10px 13px;text-align:center;position:relative;}
.date-lbl{font-family:'Hind Siliguri',sans-serif;font-size:.58rem;letter-spacing:1.5px;text-transform:uppercase;color:var(--mist);font-weight:700;margin-bottom:6px;}
.date-val{font-family:'Scheherazade New',serif;font-size:clamp(.84rem,3.8vw,1rem);color:var(--Au4);font-weight:600;line-height:1.35;}
.date-val.arab{font-family:'Noto Naskh Arabic',serif;font-size:clamp(.88rem,4vw,1.05rem);direction:rtl;}
.date-sep-v{background:linear-gradient(180deg,transparent,var(--rim2),transparent);margin:10px 0;}

/* ══════════════════════════════════════════════════
   PRAYER CARDS
══════════════════════════════════════════════════ */
.prayer-list{display:flex;flex-direction:column;gap:9px;}
.p-row{
  position:relative;background:var(--card);border:1px solid var(--rim1);border-radius:var(--r2);
  overflow:hidden;box-shadow:var(--sh1);
  transition:transform .18s ease,box-shadow .28s ease,border-color .28s ease;
  -webkit-tap-highlight-color:transparent;touch-action:manipulation;
}
.p-row:active{transform:scale(.982);}
.p-row.hl{
  background:linear-gradient(140deg,rgba(14,92,56,.38) 0%,rgba(7,18,9,.92) 65%,rgba(10,24,12,.95) 100%);
  border-color:rgba(212,168,50,.30);
  box-shadow:var(--sh1),0 0 0 1px rgba(212,168,50,.10),inset 0 1px 0 rgba(212,168,50,.10);
}
.p-row::before{
  content:'';position:absolute;left:0;top:12%;bottom:12%;
  width:3.5px;border-radius:0 4px 4px 0;
  background:linear-gradient(180deg,transparent,var(--Au4),transparent);
  opacity:0;transition:opacity .3s;
}
.p-row.hl::before{opacity:1;}
.p-row::after{
  content:'';position:absolute;top:0;left:10%;right:10%;height:1px;
  background:linear-gradient(90deg,transparent,rgba(212,168,50,.22),transparent);pointer-events:none;
}
.p-shimmer{
  position:absolute;inset:0;pointer-events:none;
  background:linear-gradient(110deg,transparent 30%,rgba(212,168,50,.04) 50%,transparent 70%);
  animation:rowSweep 8s ease-in-out infinite;
}
.p-row:nth-child(2) .p-shimmer{animation-delay:.8s;}
.p-row:nth-child(3) .p-shimmer{animation-delay:1.6s;}
.p-row:nth-child(4) .p-shimmer{animation-delay:2.4s;}
.p-row:nth-child(5) .p-shimmer{animation-delay:3.2s;}
.p-row:nth-child(6) .p-shimmer{animation-delay:4s;}
.p-row:nth-child(7) .p-shimmer{animation-delay:4.8s;}
@keyframes rowSweep{0%{transform:translateX(-100%);}55%,100%{transform:translateX(120%);}}
.p-inner{display:flex;align-items:center;gap:13px;padding:14px 16px;}
.p-badge{
  flex-shrink:0;width:48px;height:48px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;font-size:1.35rem;
  background:radial-gradient(circle at 35% 35%,rgba(212,168,50,.14),rgba(212,168,50,.05) 70%);
  border:1px solid rgba(212,168,50,.20);position:relative;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.06);
}
.p-row.hl .p-badge{
  background:radial-gradient(circle at 35% 35%,rgba(212,168,50,.22),rgba(212,168,50,.08) 70%);
  border-color:rgba(212,168,50,.36);
  box-shadow:0 0 18px rgba(212,168,50,.16),inset 0 1px 0 rgba(255,255,255,.08);
}
.p-row.hl .p-badge::after{
  content:'';position:absolute;inset:-4px;border-radius:50%;
  border:1.5px solid rgba(212,168,50,.35);
  animation:badgePing 2.5s ease-out infinite;
}
@keyframes badgePing{0%{transform:scale(1);opacity:.7;}70%,100%{transform:scale(1.5);opacity:0;}}
.p-body{flex:1;min-width:0;}
.p-name-bn{
  font-family:'Tiro Bangla',serif;font-size:clamp(1.18rem,5.5vw,1.42rem);font-weight:400;
  color:var(--ink);line-height:1.1;letter-spacing:.5px;
}
.p-row.hl .p-name-bn{
  background:linear-gradient(135deg,var(--Au6) 0%,var(--Au4) 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}
.prayer-list .p-row{animation:cardSlideIn .55s cubic-bezier(.22,1,.36,1) both;}
.prayer-list .p-row:nth-child(1){animation-delay:.08s;}
.prayer-list .p-row:nth-child(2){animation-delay:.15s;}
.prayer-list .p-row:nth-child(3){animation-delay:.22s;}
.prayer-list .p-row:nth-child(4){animation-delay:.29s;}
.prayer-list .p-row:nth-child(5){animation-delay:.36s;}
.prayer-list .p-row:nth-child(6){animation-delay:.43s;}
.prayer-list .p-row:nth-child(7){animation-delay:.50s;}
@keyframes cardSlideIn{from{opacity:0;transform:translateX(-18px) scale(.97);}to{opacity:1;transform:none;}}
.p-name-ar{font-family:'Noto Naskh Arabic',serif;font-size:.72rem;color:var(--mist);margin-top:3px;direction:rtl;letter-spacing:.5px;}
.p-time{
  font-family:'Aref Ruqaa Ink',serif;font-size:clamp(1.28rem,6vw,1.58rem);font-weight:700;
  color:var(--Au4);min-width:82px;text-align:right;flex-shrink:0;
  letter-spacing:.8px;text-shadow:0 0 16px rgba(212,168,50,.32);line-height:1;
  transition:text-shadow .4s,color .4s;
}
.p-row.hl .p-time{
  color:var(--Au6);text-shadow:0 0 28px rgba(245,216,112,.60),0 0 50px rgba(212,168,50,.25);
  animation:timePulse 3s ease-in-out infinite;
}
@keyframes timePulse{0%,100%{text-shadow:0 0 22px rgba(245,216,112,.50),0 0 40px rgba(212,168,50,.20);}50%{text-shadow:0 0 40px rgba(245,216,112,.85),0 0 70px rgba(212,168,50,.40);}}
.p-time.updated{animation:timeFlash .6s ease-out;}
@keyframes timeFlash{0%{color:var(--Au7);text-shadow:0 0 40px rgba(255,255,200,.9),0 0 80px rgba(212,168,50,.7);}100%{color:inherit;text-shadow:inherit;}}

/* ══════════════════════════════════════════════════
   ACTIVE WAQT — জ্বলন্ত অ্যানিমেশন
   JS adds .now class to the current prayer row
══════════════════════════════════════════════════ */
.p-row.now{
  background:linear-gradient(140deg,
    rgba(20,140,76,.58) 0%,
    rgba(12,44,20,.96) 50%,
    rgba(9,22,11,.98) 100%) !important;
  border-color:rgba(253,238,160,.80) !important;
  transform:scale(1.013);
  z-index:4;
  will-change:box-shadow,transform;
  box-shadow:
    0 0 0 2px   rgba(253,238,160,.55),
    0 0 24px    rgba(253,238,160,.42),
    0 0 55px    rgba(212,168,50,.32),
    0 0 100px   rgba(212,168,50,.16),
    inset 0 1px 0 rgba(253,238,160,.25) !important;
  animation: cardSlideIn .55s cubic-bezier(.22,1,.36,1) both,
             nowBreath 2s ease-in-out infinite;
}
@keyframes nowBreath{
  0%,100%{
    box-shadow:
      0 0 0 1.5px rgba(253,238,160,.45),
      0 0 18px    rgba(253,238,160,.30),
      0 0 45px    rgba(212,168,50,.22),
      0 0 85px    rgba(212,168,50,.10),
      inset 0 1px 0 rgba(253,238,160,.18);
    transform:scale(1.008);
  }
  50%{
    box-shadow:
      0 0 0 2.5px rgba(253,238,160,.92),
      0 0 36px    rgba(253,238,160,.65),
      0 0 75px    rgba(212,168,50,.46),
      0 0 130px   rgba(212,168,50,.24),
      inset 0 1px 0 rgba(253,238,160,.32);
    transform:scale(1.020);
  }
}
/* Left stripe — flame flicker */
.p-row.now::before{
  opacity:1 !important;width:5px !important;
  background:linear-gradient(180deg,transparent,var(--Au5),var(--Au7),var(--Au5),transparent) !important;
  animation:stripeFlicker 1.1s ease-in-out infinite;
}
@keyframes stripeFlicker{
  0%,100%{opacity:.75;box-shadow:0 0 8px rgba(253,238,160,.55);}
  30%    {opacity:1;  box-shadow:0 0 22px rgba(253,238,160,.95),0 0 40px rgba(212,168,50,.65);}
  70%    {opacity:.88;box-shadow:0 0 14px rgba(253,238,160,.72);}
}
/* Top edge glow */
.p-row.now::after{
  background:linear-gradient(90deg,transparent,rgba(253,238,160,.55),rgba(255,255,210,.85),rgba(253,238,160,.55),transparent) !important;
  height:1.5px !important;animation:topEdgeGlow 2s ease-in-out infinite;
}
@keyframes topEdgeGlow{0%,100%{opacity:.45;}50%{opacity:1;}}
/* Badge — inferno aura */
.p-row.now .p-badge{
  background:radial-gradient(circle at 35% 30%,rgba(253,238,160,.44),rgba(212,168,50,.20) 55%,rgba(212,168,50,.05) 100%) !important;
  border-color:rgba(253,238,160,.85) !important;
  box-shadow:0 0 26px rgba(253,238,160,.60),0 0 55px rgba(212,168,50,.40),0 0 90px rgba(212,168,50,.20),inset 0 1px 0 rgba(255,255,255,.22) !important;
  animation:badgeInferno 1.7s ease-in-out infinite;
}
@keyframes badgeInferno{
  0%,100%{box-shadow:0 0 20px rgba(253,238,160,.45),0 0 44px rgba(212,168,50,.30),0 0 75px rgba(212,168,50,.15);transform:scale(1);}
  50%    {box-shadow:0 0 36px rgba(253,238,160,.85),0 0 70px rgba(212,168,50,.60),0 0 110px rgba(212,168,50,.32);transform:scale(1.12);}
}
/* Double expanding ping rings */
.p-row.now .p-badge::after{
  content:'';position:absolute;inset:-8px;border-radius:50%;
  border:2px solid rgba(253,238,160,.72);
  animation:nowPing1 1.5s ease-out infinite !important;
}
@keyframes nowPing1{0%{transform:scale(1);opacity:.9;}100%{transform:scale(2.3);opacity:0;}}
.now-ping2{
  position:absolute;inset:-8px;border-radius:50%;
  border:1.5px solid rgba(212,168,50,.48);
  animation:nowPing2 1.5s ease-out .5s infinite;
  pointer-events:none;
}
@keyframes nowPing2{0%{transform:scale(1);opacity:.6;}100%{transform:scale(2.9);opacity:0;}}
/* Bangla name — flowing molten gold */
.p-row.now .p-name-bn{
  background:linear-gradient(90deg,var(--Au7),var(--Au5),var(--Au4),var(--Au5),var(--Au7)) !important;
  -webkit-background-clip:text !important;-webkit-text-fill-color:transparent !important;background-clip:text !important;
  background-size:300% auto;
  animation:goldFlow 2.2s linear infinite;
  filter:drop-shadow(0 0 12px rgba(253,238,160,.55));
}
@keyframes goldFlow{0%{background-position:0%;}100%{background-position:300%;}}
/* Arabic name lit */
.p-row.now .p-name-ar{color:rgba(253,238,160,.72) !important;text-shadow:0 0 10px rgba(253,238,160,.40);}
/* Time — MAX fire */
.p-row.now .p-time{
  color:var(--Au7) !important;
  font-size:clamp(1.40rem,6.8vw,1.74rem) !important;
  letter-spacing:1.2px !important;
  animation:timeInferno 1.3s ease-in-out infinite !important;
}
@keyframes timeInferno{
  0%,100%{text-shadow:0 0 20px rgba(253,238,160,.80),0 0 38px rgba(245,216,112,.55),0 0 65px rgba(212,168,50,.30);}
  50%    {text-shadow:0 0 34px rgba(255,255,220,1.0),0 0 65px rgba(253,238,160,.88),0 0 110px rgba(212,168,50,.58),0 0 160px rgba(212,168,50,.22);}
}
/* Fast shimmer sweep */
.p-row.now .p-shimmer{
  background:linear-gradient(110deg,transparent 15%,rgba(253,238,160,.14) 38%,rgba(255,255,210,.24) 50%,rgba(253,238,160,.14) 62%,transparent 85%) !important;
  animation:nowSweep 1.6s ease-in-out infinite !important;
}
@keyframes nowSweep{0%{transform:translateX(-110%);}100%{transform:translateX(120%);}}
/* "ওয়াক্ত চলছে" label */
.waqt-lbl{
  position:absolute;top:6px;right:9px;z-index:8;pointer-events:none;
  font-family:'Tiro Bangla',serif;font-size:.56rem;
  color:rgba(253,238,160,.92);
  background:rgba(20,128,72,.58);border:1px solid rgba(253,238,160,.48);
  border-radius:20px;padding:2px 9px;letter-spacing:.6px;
  backdrop-filter:blur(6px);
  animation:lblBreath 2s ease-in-out infinite;
}
@keyframes lblBreath{0%,100%{opacity:.70;box-shadow:0 0 6px rgba(253,238,160,.20);}50%{opacity:1;box-shadow:0 0 18px rgba(253,238,160,.62);}}
/* Floating ember sparks (JS spawned) */
.ember{
  position:absolute;border-radius:50%;pointer-events:none;z-index:9;
  will-change:transform,opacity;
  transform:translateZ(0);
  animation:emberFly linear forwards;
}
@keyframes emberFly{
  0%  {transform:translateY(0) translateX(0) scale(1); opacity:.95;}
  40% {opacity:.70;}
  100%{transform:translateY(-72px) translateX(var(--ex)) scale(.04); opacity:0;}
}

/* ══════════════════════════════════════════════════
   RIPPLE
══════════════════════════════════════════════════ */
.ripple-ring{
  position:absolute;border-radius:50%;background:rgba(212,168,50,.18);
  transform:scale(0);animation:ripple .55s ease-out forwards;pointer-events:none;z-index:10;
}
@keyframes ripple{from{transform:scale(0);opacity:.8;}to{transform:scale(3.5);opacity:0;}}

/* ══════════════════════════════════════════════════
   ADMIN PANEL
══════════════════════════════════════════════════ */
.adm-head{text-align:center;padding:10px 0 18px;}
.adm-head h2{
  font-family:'Tiro Bangla',serif;font-size:clamp(1.25rem,6vw,1.6rem);font-weight:400;
  background:linear-gradient(135deg,var(--Au4),var(--Au6));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;letter-spacing:.8px;
}
.adm-head p{font-family:'Tiro Bangla',serif;font-size:.78rem;color:var(--mist);margin-top:5px;letter-spacing:.3px;}
.adm-card{
  background:var(--card2);border:1px solid var(--rim1);border-radius:var(--r3);
  padding:20px 15px 22px;box-shadow:var(--sh2);position:relative;overflow:hidden;
}
.adm-card::before{content:'';position:absolute;top:0;left:0;width:40px;height:40px;border-top:1px solid var(--rim2);border-left:1px solid var(--rim2);border-radius:var(--r3) 0 0 0;}
.adm-card::after {content:'';position:absolute;bottom:0;right:0;width:40px;height:40px;border-bottom:1px solid var(--rim2);border-right:1px solid var(--rim2);border-radius:0 0 var(--r3) 0;}
.s-sep{
  display:flex;align-items:center;gap:8px;margin:16px 0 12px;
  font-family:'Hind Siliguri',sans-serif;font-size:.62rem;font-weight:700;
  letter-spacing:1.3px;text-transform:uppercase;color:var(--ash);
}
.s-sep::before,.s-sep::after{content:'';flex:1;height:1px;background:linear-gradient(90deg,transparent,var(--rim2),transparent);}
.fg{margin-bottom:11px;}
.fl{
  display:flex;align-items:center;gap:5px;
  font-family:'Tiro Bangla',serif;font-size:.72rem;font-weight:400;
  letter-spacing:.6px;color:var(--mist);margin-bottom:6px;
}
.fl .i{font-size:.82rem;}
.fi{
  width:100%;background:rgba(2,6,3,.82);border:1px solid var(--rim1);border-radius:var(--r1);
  padding:13px 15px;color:var(--ink);font-family:'Tiro Bangla',serif;font-size:1rem;font-weight:400;
  outline:none;transition:border-color .28s,box-shadow .28s,background .28s,transform .2s;
  -webkit-appearance:none;appearance:none;caret-color:var(--Au4);
}
.fi::placeholder{color:var(--ash);font-family:'Hind Siliguri',sans-serif;font-size:.78rem;font-weight:400;}
.fi:focus{border-color:rgba(212,168,50,.55);background:rgba(14,92,56,.12);box-shadow:0 0 0 3px rgba(212,168,50,.10),0 0 28px rgba(212,168,50,.06);transform:scale(1.012);}
.fgrid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.save-btn{
  width:100%;margin-top:20px;padding:17px;border:1px solid var(--rim2);border-radius:var(--r2);
  background:linear-gradient(145deg,#0b5230 0%,#12905a 40%,#0e7a4a 70%,#0b5230 100%);
  color:var(--Au6);font-family:'Tiro Bangla',serif;font-size:1.25rem;font-weight:400;letter-spacing:2px;
  cursor:pointer;position:relative;overflow:hidden;
  -webkit-tap-highlight-color:transparent;touch-action:manipulation;
  box-shadow:0 6px 28px rgba(14,92,56,.45),0 0 0 1px rgba(212,168,50,.22),inset 0 1px 0 rgba(255,255,255,.14),inset 0 -1px 0 rgba(0,0,0,.25);
  animation:btnHalo 3.5s ease-in-out infinite;
  transition:transform .25s,box-shadow .25s;
  text-shadow:0 2px 8px rgba(0,0,0,.5);
}
@keyframes btnHalo{
  0%,100%{box-shadow:0 6px 26px rgba(14,92,56,.40),0 0 0 1px rgba(212,168,50,.20),inset 0 1px 0 rgba(255,255,255,.12);}
  50%    {box-shadow:0 6px 40px rgba(14,92,56,.75),0 0 40px rgba(212,168,50,.35),0 0 0 1px rgba(212,168,50,.55),inset 0 1px 0 rgba(255,255,255,.18);}
}
.save-btn::before{content:'';position:absolute;top:0;left:-100%;width:55%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.14),transparent);transition:left .6s ease;}
.save-btn:hover::before{left:160%;}
.save-btn:hover{transform:translateY(-2px);}
.save-btn:active{transform:scale(.97);}
.save-btn span{
  background:linear-gradient(90deg,var(--Au5),var(--Au7),var(--Au5));background-size:200% auto;
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  animation:goldText 3s linear infinite;
}
@keyframes goldText{from{background-position:0%;}to{background-position:200%;}}

/* ══════════════════════════════════════════════════
   MOBILE FIXED SAVE BAR
══════════════════════════════════════════════════ */
.mobile-save-bar{display:none;position:fixed;bottom:0;left:0;right:0;z-index:300;padding:10px 16px calc(env(safe-area-inset-bottom,0px) + 10px);background:linear-gradient(0deg,rgba(1,4,2,.98),rgba(1,4,2,.88));backdrop-filter:blur(18px);-webkit-backdrop-filter:blur(18px);border-top:1px solid var(--rim1);}
@media(max-width:560px){.mobile-save-bar{display:block;}.adm-card .save-btn{display:none;}.tail{height:100px;}}
.mobile-save-btn{
  width:100%;padding:15px;border:1px solid var(--rim2);border-radius:var(--r2);
  background:linear-gradient(145deg,#0b5230 0%,#12905a 40%,#0e7a4a 70%,#0b5230 100%);
  color:var(--Au6);font-family:'Tiro Bangla',serif;font-size:1.12rem;font-weight:400;letter-spacing:1.5px;
  cursor:pointer;position:relative;overflow:hidden;
  -webkit-tap-highlight-color:transparent;touch-action:manipulation;
  box-shadow:0 4px 20px rgba(14,92,56,.5),0 0 0 1px rgba(212,168,50,.22),inset 0 1px 0 rgba(255,255,255,.14);
  animation:btnHalo 3s ease-in-out infinite;
}
.mobile-save-btn:active{transform:scale(.97);}

/* ══════════════════════════════════════════════════
   TOAST + PARTICLES
══════════════════════════════════════════════════ */
.toast{
  position:fixed;bottom:calc(env(safe-area-inset-bottom,0px) + 26px);left:50%;
  transform:translateX(-50%) translateY(90px) scale(.9);opacity:0;pointer-events:none;
  background:linear-gradient(145deg,rgba(10,50,25,.98),rgba(6,20,10,.98));
  border:1px solid rgba(212,168,50,.55);border-radius:100px;padding:14px 30px;
  font-family:'Tiro Bangla',serif;font-size:1.08rem;font-weight:400;color:var(--Au5);
  z-index:9999;white-space:nowrap;letter-spacing:1px;
  backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);
  box-shadow:0 12px 48px rgba(0,0,0,.65),0 0 40px rgba(212,168,50,.25),inset 0 1px 0 rgba(212,168,50,.2);
  transition:transform .48s cubic-bezier(.34,1.56,.64,1),opacity .38s ease;
}
.toast.show{transform:translateX(-50%) translateY(0) scale(1);opacity:1;}
#pcl{position:fixed;inset:0;pointer-events:none;z-index:9998;overflow:hidden;}
.pc{position:absolute;animation:pcfly 1.8s ease-out forwards;}
@keyframes pcfly{0%{opacity:1;transform:translateY(0) rotate(0) scale(1);}15%{opacity:1;}80%{opacity:.5;}100%{opacity:0;transform:translateY(-180px) rotate(240deg) scale(.06);}}
.tail{height:48px;}

/* ══════════════════════════════════════════════════
   RESPONSIVE
══════════════════════════════════════════════════ */
@media(max-width:380px){
  .date-lbl{font-size:.55rem;letter-spacing:1px;}
  .date-val{font-size:.82rem;}
  .p-inner{padding:12px 13px;gap:11px;}
  .p-badge{width:44px;height:44px;font-size:1.22rem;}
  .p-name-bn{font-size:1.1rem;}
  .p-time{font-size:1.18rem;min-width:72px;}
}
@media(min-width:560px){.root{max-width:510px;}.p-badge{width:52px;height:52px;font-size:1.42rem;}.p-name-bn{font-size:1.48rem;}.p-time{font-size:1.55rem;min-width:86px;}}
@media(min-width:860px){.root{max-width:640px;}.p-name-bn{font-size:1.62rem;}.p-time{font-size:1.7rem;}.mosque-name{font-size:2.6rem;}}
@media(min-width:1280px){.root{max-width:800px;}.p-inner{padding:20px 24px;}.p-badge{width:60px;height:60px;font-size:1.65rem;}.p-name-bn{font-size:1.92rem;}.p-time{font-size:2rem;min-width:110px;}}
@media(min-width:1800px){.root{max-width:1020px;}.p-inner{padding:26px 32px;gap:18px;}.p-badge{width:74px;height:74px;font-size:2rem;}.p-name-bn{font-size:2.4rem;}.p-time{font-size:2.5rem;min-width:145px;}}

/* ══════════════════════════════════════════════════
   IFTAR / SEHRI COUNTDOWN PANEL — UPGRADED
══════════════════════════════════════════════════ */
.countdown-panel{
  position:relative;
  background:linear-gradient(160deg,rgba(10,28,14,.97) 0%,rgba(7,18,9,.98) 60%,rgba(12,32,16,.97) 100%);
  border:1px solid var(--rim2);
  border-radius:var(--r3);
  margin-bottom:12px;
  overflow:hidden;
  box-shadow:var(--sh2),0 0 0 1px rgba(212,168,50,.14),0 0 50px rgba(14,92,56,.20),inset 0 1px 0 rgba(212,168,50,.18);
  padding:16px 10px 14px;
}
.countdown-panel::before{
  content:'';position:absolute;top:0;left:0;right:0;height:3px;
  background:linear-gradient(90deg,transparent 0%,var(--Au3) 20%,var(--Au6) 50%,var(--Au3) 80%,transparent 100%);
}
.countdown-panel::after{
  content:'';position:absolute;bottom:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent 0%,var(--rim2) 40%,var(--rim3) 50%,var(--rim2) 60%,transparent 100%);
}
.cdp-corner{position:absolute;width:18px;height:18px;pointer-events:none;}
.cdp-corner.tl{top:5px;left:5px;border-top:1px solid var(--rim3);border-left:1px solid var(--rim3);border-radius:4px 0 0 0;}
.cdp-corner.tr{top:5px;right:5px;border-top:1px solid var(--rim3);border-right:1px solid var(--rim3);border-radius:0 4px 0 0;}
.cdp-corner.bl{bottom:5px;left:5px;border-bottom:1px solid var(--rim2);border-left:1px solid var(--rim2);border-radius:0 0 0 4px;}
.cdp-corner.br{bottom:5px;right:5px;border-bottom:1px solid var(--rim2);border-right:1px solid var(--rim2);border-radius:0 0 4px 0;}
.cdp-header{
  display:flex;align-items:center;justify-content:center;gap:6px;
  margin-bottom:12px;
  flex-wrap:wrap;
}
.cdp-title{
  font-family:'Aref Ruqaa Ink',serif;
  font-size:clamp(.72rem,3.2vw,.92rem);
  letter-spacing:2px;
  background:linear-gradient(135deg,var(--Au4),var(--Au6),var(--Au4));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  font-weight:700;white-space:nowrap;
}
.cdp-gem{
  width:7px;height:7px;background:var(--Au4);
  transform:rotate(45deg);box-shadow:0 0 10px var(--Au4),0 0 20px rgba(212,168,50,.4);
  flex-shrink:0;
}
.cdp-star{font-size:.8rem;color:var(--Au4);opacity:.7;flex-shrink:0;}

.cdp-grid{display:grid;grid-template-columns:1fr 1px 1fr;}
.cdp-sep{background:linear-gradient(180deg,transparent 0%,var(--rim3) 30%,var(--rim3) 70%,transparent 100%);margin:4px 0;}
.cdp-item{text-align:center;padding:4px 6px 8px;position:relative;}
.cdp-label{
  font-family:'Hind Siliguri',sans-serif;
  font-size:clamp(.52rem,2.4vw,.65rem);
  letter-spacing:1.4px;text-transform:uppercase;
  font-weight:700;margin-bottom:8px;
  display:flex;align-items:center;justify-content:center;gap:4px;
}
.cdp-item.iftar .cdp-label{color:var(--Au5);}
.cdp-item.sehri .cdp-label{color:#7de8c0;}

.cdp-time-wrap{display:flex;align-items:stretch;justify-content:center;gap:3px;}
.cdp-digit-box{display:flex;flex-direction:column;align-items:center;gap:2px;}

/* RESPONSIVE digit sizes */
.cdp-hh,.cdp-mm,.cdp-ss{
  font-family:'Aref Ruqaa Ink',serif;
  font-size:clamp(1.45rem,6.5vw,2.2rem);
  font-weight:700;
  line-height:1;
  min-width:2ch;text-align:center;
  display:block;
  border-radius:6px;
  padding:5px 6px 3px;
}
.cdp-item.iftar .cdp-hh,
.cdp-item.iftar .cdp-mm,
.cdp-item.iftar .cdp-ss{
  color:var(--Au7);
  text-shadow:0 0 18px rgba(245,216,112,.75),0 0 36px rgba(212,168,50,.35);
  background:rgba(212,168,50,.08);
  border:1px solid rgba(212,168,50,.22);
  box-shadow:inset 0 1px 0 rgba(255,255,255,.06),0 2px 10px rgba(0,0,0,.4);
}
.cdp-item.sehri .cdp-hh,
.cdp-item.sehri .cdp-mm,
.cdp-item.sehri .cdp-ss{
  color:#b8fce0;
  text-shadow:0 0 16px rgba(125,232,192,.70),0 0 32px rgba(79,201,154,.30);
  background:rgba(21,156,94,.10);
  border:1px solid rgba(79,201,154,.25);
  box-shadow:inset 0 1px 0 rgba(255,255,255,.06),0 2px 10px rgba(0,0,0,.4);
}
.cdp-digit-lbl{
  font-family:'Hind Siliguri',sans-serif;
  font-size:clamp(.38rem,1.5vw,.46rem);
  letter-spacing:.8px;text-transform:uppercase;
  color:var(--ash);font-weight:700;
}
.cdp-colon{
  font-family:'Aref Ruqaa Ink',serif;
  font-size:clamp(1.1rem,5vw,1.8rem);
  color:var(--Au3);line-height:1;
  align-self:center;padding-bottom:14px;
  animation:colonBlink 1s step-end infinite;
}
.cdp-item.sehri .cdp-colon{color:#4fc99a;}
@keyframes colonBlink{0%,100%{opacity:1;}50%{opacity:.15;}}
.cdp-sublabel{
  font-family:'Tiro Bangla',serif;
  font-size:clamp(.52rem,2.4vw,.66rem);
  margin-top:8px;letter-spacing:.3px;
  padding:3px 6px;border-radius:16px;display:inline-block;
  line-height:1.4;
}
.cdp-item.iftar .cdp-sublabel{
  color:rgba(245,216,112,.80);
  background:rgba(212,168,50,.08);border:1px solid rgba(212,168,50,.18);
}
.cdp-item.sehri .cdp-sublabel{
  color:rgba(125,232,192,.80);
  background:rgba(21,156,94,.08);border:1px solid rgba(79,201,154,.20);
}
.cdp-done{
  font-family:'Tiro Bangla',serif;
  font-size:clamp(.78rem,3.5vw,.95rem);
  color:var(--Au5);text-shadow:0 0 14px rgba(245,216,112,.6);padding:4px 0;
}

/* ══════════════════════════════════════════════════
   VISITOR COUNTER — compact Islamic design
══════════════════════════════════════════════════ */
.visitor-footer{
  text-align:center;
  padding:4px 0 12px;
  user-select:none;
}
.visitor-card{
  position:relative;
  display:inline-block;
  width:100%;
  background:linear-gradient(160deg,rgba(10,28,14,.97) 0%,rgba(7,18,9,.98) 60%,rgba(12,32,16,.97) 100%);
  border:1px solid var(--rim2);
  border-radius:var(--r2);
  overflow:hidden;
  padding:13px 14px 11px;
  box-shadow:0 6px 24px rgba(0,0,0,.50),0 0 0 1px rgba(212,168,50,.10),inset 0 1px 0 rgba(212,168,50,.12);
}
.visitor-card::before{
  content:'';position:absolute;top:0;left:0;right:0;height:2px;
  background:linear-gradient(90deg,transparent,var(--Au3),var(--Au5),var(--Au3),transparent);
}
.visitor-card::after{
  content:'';position:absolute;bottom:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,var(--rim2),transparent);
}
.visitor-geo{
  position:absolute;inset:0;pointer-events:none;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cg fill='none' stroke='%23d4a832' stroke-opacity='.06'%3E%3Cpolygon points='60,5 73,40 108,40 80,62 91,97 60,75 29,97 40,62 12,40 47,40' stroke-width='1'/%3E%3Ccircle cx='60' cy='60' r='42' stroke-width='.6'/%3E%3Ccircle cx='60' cy='60' r='26' stroke-width='.4'/%3E%3C/g%3E%3C/svg%3E");
  background-size:120px 120px;background-position:center;
}
.visitor-card .cdp-corner.tl{top:4px;left:4px;}
.visitor-card .cdp-corner.tr{top:4px;right:4px;}
.visitor-card .cdp-corner.bl{bottom:4px;left:4px;}
.visitor-card .cdp-corner.br{bottom:4px;right:4px;}
.visitor-arabic{
  font-family:'Noto Naskh Arabic',serif;
  font-size:clamp(.78rem,3.5vw,.92rem);
  color:rgba(212,168,50,.42);
  display:block;text-align:center;direction:rtl;letter-spacing:1px;
  margin-bottom:5px;
}
.visitor-title-row{
  display:flex;align-items:center;justify-content:center;gap:7px;
  margin-bottom:10px;
}
.visitor-gem{width:6px;height:6px;background:var(--jade3);transform:rotate(45deg);box-shadow:0 0 8px rgba(21,156,94,.8);flex-shrink:0;}
.visitor-title{font-family:'Hind Siliguri',sans-serif;font-size:.58rem;letter-spacing:2px;text-transform:uppercase;color:var(--mist);font-weight:700;}
.visitor-number-wrap{display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:10px;}
.visitor-icon-wrap{
  width:42px;height:42px;border-radius:50%;
  background:radial-gradient(circle at 35% 35%,rgba(21,156,94,.20),rgba(14,92,56,.06) 70%);
  border:1px solid rgba(21,156,94,.28);
  box-shadow:0 0 16px rgba(21,156,94,.18),inset 0 1px 0 rgba(255,255,255,.05);
  display:flex;align-items:center;justify-content:center;
  font-size:1.35rem;flex-shrink:0;position:relative;
}
.visitor-icon-wrap::after{
  content:'';position:absolute;inset:-4px;border-radius:50%;
  border:1px solid rgba(21,156,94,.20);
  animation:vcRing 2.4s ease-out infinite;
}
@keyframes vcRing{0%{transform:scale(1);opacity:.5;}100%{transform:scale(1.5);opacity:0;}}
.visitor-num-col{text-align:left;}
.visitor-count{
  font-family:'Aref Ruqaa Ink',serif;
  font-size:clamp(1.7rem,8vw,2.3rem);
  font-weight:700;
  background:linear-gradient(135deg,var(--Au5) 0%,var(--Au7) 45%,var(--Au4) 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  line-height:1;display:block;
  filter:drop-shadow(0 0 10px rgba(212,168,50,.45));
}
.visitor-unit{font-family:'Tiro Bangla',serif;font-size:.62rem;color:var(--mist);letter-spacing:.6px;margin-top:2px;display:block;}
.visitor-live-row{
  display:flex;align-items:center;justify-content:center;gap:6px;
  padding-top:8px;border-top:1px solid rgba(212,168,50,.10);
}
.visitor-dot{
  width:6px;height:6px;border-radius:50%;
  background:var(--jade3);
  box-shadow:0 0 7px rgba(21,156,94,.9),0 0 14px rgba(21,156,94,.4);
  animation:livePulse 1.2s ease-in-out infinite alternate;flex-shrink:0;
}
.visitor-live-txt{font-family:'Hind Siliguri',sans-serif;font-size:.56rem;letter-spacing:1.2px;text-transform:uppercase;color:rgba(80,220,140,.70);font-weight:700;}
.visitor-live-count{margin-left:auto;font-family:'Hind Siliguri',sans-serif;font-size:.50rem;color:var(--ash);letter-spacing:.6px;}

/* ══════════════════════════════════════════════════
   ISLAMIC SPEECH FOOTER
══════════════════════════════════════════════════ */
.islamic-footer{
  position:relative;
  margin:10px 0 6px;
  padding:18px 14px 16px;
  text-align:center;
  background:linear-gradient(160deg,rgba(8,22,10,.95) 0%,rgba(5,14,7,.98) 100%);
  border:1px solid var(--rim1);
  border-radius:var(--r2);
  overflow:hidden;
}
.islamic-footer::before{
  content:'';position:absolute;top:0;left:0;right:0;height:2px;
  background:linear-gradient(90deg,transparent,var(--Au2),var(--Au4),var(--Au2),transparent);
  opacity:.6;
}
.islamic-footer::after{
  content:'';position:absolute;bottom:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,var(--rim1),transparent);
}
.isf-top-orn{
  display:flex;align-items:center;justify-content:center;gap:8px;
  margin-bottom:12px;
}
.isf-line{flex:1;height:1px;background:linear-gradient(90deg,transparent,var(--rim2),transparent);}
.isf-diamond{width:6px;height:6px;background:var(--Au3);transform:rotate(45deg);box-shadow:0 0 8px var(--Au3);flex-shrink:0;}
.isf-speech{
  font-family:'Aref Ruqaa Ink',serif;
  font-size:clamp(1rem,4.5vw,1.3rem);
  font-weight:700;
  line-height:1.75;
  letter-spacing:.5px;
  background:linear-gradient(160deg,var(--Au6) 0%,var(--Au4) 50%,var(--Au5) 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  filter:drop-shadow(0 0 10px rgba(212,168,50,.25));
  display:block;margin-bottom:8px;
}
.isf-source{
  font-family:'Tiro Bangla',serif;
  font-size:clamp(.56rem,2.5vw,.68rem);
  color:var(--mist);letter-spacing:.6px;
  font-style:italic;
  display:block;margin-top:4px;
}

/* visitor footer CSS now above */

/* ══════════════════════════════════════════════════
   MOBILE PERFORMANCE OVERRIDES
   Strips the most GPU-hungry effects on small screens
══════════════════════════════════════════════════ */
@media(max-width:600px){
  /* Kill box-shadow animations — biggest GPU win */
  .p-row.now{
    animation: cardSlideIn .45s cubic-bezier(.22,1,.36,1) both !important;
    box-shadow:
      0 0 0 2px rgba(253,238,160,.55),
      0 0 20px rgba(212,168,50,.25) !important;
    will-change: transform;
  }
  /* Simplify nowBreath to opacity only */
  @keyframes nowBreath{
    0%,100%{opacity:.92;}
    50%    {opacity:1;}
  }
  /* Simplify badge — no scale pulse */
  .p-row.now .p-badge{
    animation: none !important;
    box-shadow:0 0 16px rgba(253,238,160,.40) !important;
  }
  /* Kill ping rings on mobile */
  .p-row.now .p-badge::after{ animation:none !important; opacity:0 !important; }
  .now-ping2{ animation:none !important; opacity:0 !important; }
  /* Simplify time animation */
  @keyframes timeInferno{
    0%,100%{text-shadow:0 0 18px rgba(253,238,160,.70);}
    50%    {text-shadow:0 0 28px rgba(255,255,220,.95);}
  }
  /* Kill stripe flicker */
  @keyframes stripeFlicker{ 0%,100%{opacity:.85;} }
  /* Kill top-edge glow animation */
  @keyframes topEdgeGlow{ 0%,100%{opacity:.6;} }
  /* Kill shimmer sweeps on all rows — saves many concurrent animations */
  .p-shimmer{ animation:none !important; opacity:0; }
  /* Slow down halo spin */
  .halo::before{ animation-duration:20s !important; }
  /* Simplify dome levitation */
  @keyframes domeLevitate{
    0%,100%{transform:translateY(0);}
    50%    {transform:translateY(-6px);}
  }
  /* Kill basmala breath — static text shadow */
  .basmala{ animation:none !important; }
  /* Kill banner sweep */
  .date-banner-inner{ animation:none !important; opacity:0; }
  /* Kill btn halo pulse */
  .save-btn,.mobile-save-btn{ animation:none !important; }
  /* Reduce backdrop-filter usage */
  .tab-rail{ backdrop-filter:none; -webkit-backdrop-filter:none; }
}
</style>
</head>
<body>

<!-- BG -->
<div class="bg-atmo"></div>
<div class="bg-geo"></div>
<div class="bg-cali" aria-hidden="true"><span class="bg-cali-text">الله</span></div>
<div class="bg-cali2" aria-hidden="true">محمد</div>
<div class="bg-vig"></div>
<div class="dust" id="dust" aria-hidden="true"></div>

<!-- CROWN -->
<div class="crown" aria-hidden="true">
  <div class="crown-top"></div>
  <div class="crown-glow"></div>
</div>

<!-- OVERLAY -->
<div id="pcl" aria-hidden="true"></div>
<div class="toast" id="toast" role="alert" aria-live="polite">✦ &nbsp; সফলভাবে সংরক্ষিত হয়েছে &nbsp; ✦</div>

<!-- ROOT -->
<div class="root">

  <!-- HERO -->
  <header class="hero">
    <div class="halo">
      <svg class="dome-svg" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="gTop" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#fff8d0"/><stop offset="40%" stop-color="#f5d870"/><stop offset="80%" stop-color="#d4a832"/><stop offset="100%" stop-color="#8a6010"/></linearGradient>
          <linearGradient id="gBody" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#e8bf50"/><stop offset="100%" stop-color="#7a5010"/></linearGradient>
          <linearGradient id="gWall" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#d4a832"/><stop offset="100%" stop-color="#6a4408"/></linearGradient>
          <filter id="glow" x="-30%" y="-30%" width="160%" height="160%"><feGaussianBlur stdDeviation="1.8" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
          <filter id="glow2" x="-50%" y="-50%" width="200%" height="200%"><feGaussianBlur stdDeviation="2.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
        </defs>
        <rect x="7" y="44" width="10" height="38" rx="2.5" fill="url(#gWall)" opacity=".88"/>
        <path d="M7 44 Q12 33 17 44Z" fill="url(#gTop)"/>
        <rect x="9" y="52" width="6" height="2" rx="1" fill="rgba(255,248,208,.25)"/>
        <rect x="9" y="58" width="6" height="2" rx="1" fill="rgba(255,248,208,.2)"/>
        <circle cx="12" cy="31" r="3.5" fill="#fff8d0" filter="url(#glow)"/>
        <rect x="83" y="44" width="10" height="38" rx="2.5" fill="url(#gWall)" opacity=".88"/>
        <path d="M83 44 Q88 33 93 44Z" fill="url(#gTop)"/>
        <rect x="85" y="52" width="6" height="2" rx="1" fill="rgba(255,248,208,.25)"/>
        <rect x="85" y="58" width="6" height="2" rx="1" fill="rgba(255,248,208,.2)"/>
        <circle cx="88" cy="31" r="3.5" fill="#fff8d0" filter="url(#glow)"/>
        <rect x="20" y="60" width="60" height="22" rx="3" fill="url(#gBody)" opacity=".80"/>
        <path d="M32 82 Q36 72 40 82Z" fill="rgba(2,6,3,.60)"/>
        <path d="M60 82 Q64 72 68 82Z" fill="rgba(2,6,3,.60)"/>
        <path d="M20 60 Q30 46 40 60Z" fill="url(#gBody)" opacity=".82"/>
        <path d="M60 60 Q70 46 80 60Z" fill="url(#gBody)" opacity=".82"/>
        <path d="M22 60 Q50 14 78 60Z" fill="url(#gTop)"/>
        <path d="M35 58 Q50 28 65 58Z" fill="rgba(255,248,208,.08)"/>
        <path d="M36 82 Q50 58 64 82Z" fill="rgba(2,6,3,.68)"/>
        <g filter="url(#glow2)">
          <circle cx="50" cy="10.5" r="6.5" fill="none" stroke="#fff8d0" stroke-width="2"/>
          <circle cx="54" cy="8.5" r="5" fill="rgba(1,4,2,.96)"/>
          <polygon points="50,3 51,6 54,6 52,8 53,11 50,9 47,11 48,8 46,6 49,6" fill="#fff8d0" opacity=".7" transform="scale(.5) translate(50,-3)"/>
        </g>
      </svg>
    </div>
    <span class="basmala" lang="ar">بِسْمِ ٱللَّهِ ٱلرَّحْمَٰنِ ٱلرَّحِيمِ</span>
    <h1 class="mosque-name" id="mosque-name">আল-নূর জামে মসজিদ</h1>
    <div class="orn" aria-hidden="true">
      <div class="orn-l"></div><span class="orn-dot">✦</span>
      <div class="orn-d"></div><span class="orn-dot">✦</span><div class="orn-l"></div>
    </div>
  </header>

  <!-- TABS -->
  <nav class="tab-rail" role="navigation" aria-label="প্রধান নেভিগেশন">
    <div class="tab-bar" role="tablist">
      <button class="t-btn on" id="tb-s" onclick="sw('s')" role="tab" aria-selected="true"  aria-controls="pn-s">📿 নামাজের সময়সূচি</button>
      <button class="t-btn"    id="tb-a" onclick="sw('a')" role="tab" aria-selected="false" aria-controls="pn-a">⚙️ সময় আপডেট</button>
    </div>
  </nav>

  <!-- SCHEDULE PANEL -->
  <section class="panel on" id="pn-s" role="tabpanel" aria-labelledby="tb-s">
    <div class="live-dot" id="status-dot" aria-live="polite">
      <span class="dot"></span><span id="status-txt">সংযোগ হচ্ছে...</span>
    </div>
    <div class="date-banner" role="complementary" aria-label="তারিখ">
      <div class="date-banner-inner"></div>
      <div class="date-col">
        <div class="date-lbl">📅 ইংরেজি তারিখ</div>
        <div class="date-val" id="d-eng">—</div>
      </div>
      <div class="date-sep-v"></div>
      <div class="date-col">
        <div class="date-lbl">🌙 হিজরি তারিখ</div>
        <div class="date-val arab" id="d-hij" lang="ar">—</div>
      </div>
    </div>

    <!-- IFTAR / SEHRI COUNTDOWN -->
    <div class="countdown-panel" role="complementary" aria-label="ইফতার ও সেহরির কাউন্টডাউন">
      <div class="cdp-corner tl"></div><div class="cdp-corner tr"></div>
      <div class="cdp-corner bl"></div><div class="cdp-corner br"></div>
      <div class="cdp-header">
        <div class="cdp-gem"></div>
        <span class="cdp-star">✦</span>
        <span class="cdp-title">ইফতার ও সেহরির বাকি সময়</span>
        <span class="cdp-star">✦</span>
        <div class="cdp-gem"></div>
      </div>
      <div class="cdp-grid">
        <!-- IFTAR -->
        <div class="cdp-item iftar">
          <div class="cdp-label">🌇 ইফতার</div>
          <div id="cdp-iftar-body">
            <div class="cdp-time-wrap">
              <div class="cdp-digit-box">
                <span class="cdp-hh" id="cdp-iftar-h">--</span>
                <span class="cdp-digit-lbl">ঘণ্টা</span>
              </div>
              <span class="cdp-colon">:</span>
              <div class="cdp-digit-box">
                <span class="cdp-mm" id="cdp-iftar-m">--</span>
                <span class="cdp-digit-lbl">মিনিট</span>
              </div>
              <span class="cdp-colon">:</span>
              <div class="cdp-digit-box">
                <span class="cdp-ss" id="cdp-iftar-s">--</span>
                <span class="cdp-digit-lbl">সেকেন্ড</span>
              </div>
            </div>
            <div class="cdp-sublabel" id="cdp-iftar-lbl">অপেক্ষা করুন...</div>
          </div>
        </div>
        <!-- SEPARATOR -->
        <div class="cdp-sep"></div>
        <!-- SEHRI -->
        <div class="cdp-item sehri">
          <div class="cdp-label">🌙 সেহরি</div>
          <div id="cdp-sehri-body">
            <div class="cdp-time-wrap">
              <div class="cdp-digit-box">
                <span class="cdp-hh" id="cdp-sehri-h">--</span>
                <span class="cdp-digit-lbl">ঘণ্টা</span>
              </div>
              <span class="cdp-colon">:</span>
              <div class="cdp-digit-box">
                <span class="cdp-mm" id="cdp-sehri-m">--</span>
                <span class="cdp-digit-lbl">মিনিট</span>
              </div>
              <span class="cdp-colon">:</span>
              <div class="cdp-digit-box">
                <span class="cdp-ss" id="cdp-sehri-s">--</span>
                <span class="cdp-digit-lbl">সেকেন্ড</span>
              </div>
            </div>
            <div class="cdp-sublabel" id="cdp-sehri-lbl">অপেক্ষা করুন...</div>
          </div>
        </div>
      </div>
    </div>

    <div class="prayer-list" role="list">
      <!-- data-key used by JS to match prayer name -->
      <div class="p-row hl" role="listitem" data-key="sehri">
        <div class="p-shimmer"></div>
        <div class="p-inner">
          <div class="p-badge" aria-hidden="true">🌙</div>
          <div class="p-body">
            <div class="p-name-bn">সেহরি</div>
            <div class="p-name-ar" lang="ar">السحور</div>
          </div>
          <div class="p-time" id="t-sehri" aria-label="সেহরির সময়">— : —</div>
        </div>
      </div>
      <div class="p-row" role="listitem" data-key="fajr">
        <div class="p-shimmer"></div>
        <div class="p-inner">
          <div class="p-badge" aria-hidden="true">🌄</div>
          <div class="p-body">
            <div class="p-name-bn">ফজর</div>
            <div class="p-name-ar" lang="ar">الفجر</div>
          </div>
          <div class="p-time" id="t-fajr" aria-label="ফজরের সময়">— : —</div>
        </div>
      </div>
      <div class="p-row" role="listitem" data-key="zuhr">
        <div class="p-shimmer"></div>
        <div class="p-inner">
          <div class="p-badge" aria-hidden="true">☀️</div>
          <div class="p-body">
            <div class="p-name-bn">যোহর</div>
            <div class="p-name-ar" lang="ar">الظهر</div>
          </div>
          <div class="p-time" id="t-zuhr" aria-label="যোহরের সময়">— : —</div>
        </div>
      </div>
      <div class="p-row" role="listitem" data-key="asr">
        <div class="p-shimmer"></div>
        <div class="p-inner">
          <div class="p-badge" aria-hidden="true">🌤</div>
          <div class="p-body">
            <div class="p-name-bn">আসর</div>
            <div class="p-name-ar" lang="ar">العصر</div>
          </div>
          <div class="p-time" id="t-asr" aria-label="আসরের সময়">— : —</div>
        </div>
      </div>
      <div class="p-row hl" role="listitem" data-key="iftar">
        <div class="p-shimmer"></div>
        <div class="p-inner">
          <div class="p-badge" aria-hidden="true">🌇</div>
          <div class="p-body">
            <div class="p-name-bn">ইফতার</div>
            <div class="p-name-ar" lang="ar">الإفطار</div>
          </div>
          <div class="p-time" id="t-iftar" aria-label="ইফতারের সময়">— : —</div>
        </div>
      </div>
      <div class="p-row" role="listitem" data-key="maghrib">
        <div class="p-shimmer"></div>
        <div class="p-inner">
          <div class="p-badge" aria-hidden="true">🌆</div>
          <div class="p-body">
            <div class="p-name-bn">মাগরিব</div>
            <div class="p-name-ar" lang="ar">المغرب</div>
          </div>
          <div class="p-time" id="t-maghrib" aria-label="মাগরিবের সময়">— : —</div>
        </div>
      </div>
      <div class="p-row" role="listitem" data-key="isha">
        <div class="p-shimmer"></div>
        <div class="p-inner">
          <div class="p-badge" aria-hidden="true">🌃</div>
          <div class="p-body">
            <div class="p-name-bn">এশা</div>
            <div class="p-name-ar" lang="ar">العشاء</div>
          </div>
          <div class="p-time" id="t-isha" aria-label="এশার সময়">— : —</div>
        </div>
      </div>
    </div>
  </section>

  <!-- ADMIN PANEL -->
  <section class="panel" id="pn-a" role="tabpanel" aria-labelledby="tb-a">
    <div class="adm-head">
      <h2>✦ সময়সূচি আপডেট করুন ✦</h2>
      <p>নিচের ফর্মে তথ্য পূরণ করে সংরক্ষণ করুন</p>
    </div>
    <div class="adm-card">
      <div class="fg">
        <label class="fl" for="i-mosque"><span class="i">🕌</span> মসজিদের নাম</label>
        <input type="text" id="i-mosque" class="fi" placeholder="মসজিদের নাম লিখুন" autocomplete="off">
      </div>
      <div class="s-sep">নামাজের ওয়াক্ত</div>
      <div class="fgrid">
        <div class="fg"><label class="fl" for="i-sehri"><span class="i">🌙</span> সেহরি</label><input type="text" id="i-sehri" class="fi" placeholder="৪:৩০ AM"></div>
        <div class="fg"><label class="fl" for="i-fajr"><span class="i">🌄</span> ফজর</label><input type="text" id="i-fajr" class="fi" placeholder="৫:০০ AM"></div>
        <div class="fg"><label class="fl" for="i-zuhr"><span class="i">☀️</span> যোহর</label><input type="text" id="i-zuhr" class="fi" placeholder="১২:৩০ PM"></div>
        <div class="fg"><label class="fl" for="i-asr"><span class="i">🌤</span> আসর</label><input type="text" id="i-asr" class="fi" placeholder="৪:১৫ PM"></div>
        <div class="fg"><label class="fl" for="i-iftar"><span class="i">🌇</span> ইফতার</label><input type="text" id="i-iftar" class="fi" placeholder="৬:৪৫ PM"></div>
        <div class="fg"><label class="fl" for="i-maghrib"><span class="i">🌆</span> মাগরিব</label><input type="text" id="i-maghrib" class="fi" placeholder="৬:৫০ PM"></div>
      </div>
      <div class="fg"><label class="fl" for="i-isha"><span class="i">🌃</span> এশা</label><input type="text" id="i-isha" class="fi" placeholder="৮:৩০ PM"></div>
      <button class="save-btn" onclick="save()" aria-label="সংরক্ষণ করুন">
        <span>✦ &nbsp; সংরক্ষণ করুন &nbsp; ✦</span>
      </button>
    </div>
  </section>

  <div class="tail"></div>

  <!-- VISITOR COUNTER — ULTRA ISLAMIC DESIGN -->
  <div class="visitor-footer">
    <div class="visitor-card">
      <div class="visitor-geo"></div>
      <div class="cdp-corner tl"></div><div class="cdp-corner tr"></div>
      <div class="cdp-corner bl"></div><div class="cdp-corner br"></div>
      <span class="visitor-arabic">أَهْلاً وَسَهْلاً بِالزُّوَّار</span>
      <div class="visitor-title-row">
        <div class="visitor-gem"></div>
        <span class="visitor-title">মোট পরিদর্শক</span>
        <div class="visitor-gem"></div>
      </div>
      <div class="visitor-number-wrap">
        <div class="visitor-icon-wrap">🕌</div>
        <div class="visitor-num-col">
          <span class="visitor-count" id="visitor-count">...</span>
          <span class="visitor-unit">জন পরিদর্শন করেছেন</span>
        </div>
      </div>
      <div class="visitor-live-row">
        <span class="visitor-dot"></span>
        <span class="visitor-live-txt">লাইভ কাউন্টার</span>
        <span class="visitor-live-count">Firebase Realtime DB</span>
      </div>
    </div>
  <!-- ISLAMIC SPEECH FOOTER -->
  <div class="islamic-footer" role="contentinfo">
    <div class="isf-top-orn">
      <div class="isf-line"></div>
      <div class="isf-diamond"></div>
      <div class="isf-line"></div>
    </div>
    <span class="isf-speech">
      "নামাজ হলো মুমিনের মিরাজ —<br>
      প্রতিটি সিজদায় আল্লাহর সান্নিধ্য পাওয়া যায়।"
    </span>
    <span class="isf-source">— হাদিস শরিফ</span>

    <div class="isf-top-orn" style="margin-top:14px;margin-bottom:12px;">
      <div class="isf-line"></div>
      <div class="isf-diamond"></div>
      <div class="isf-line"></div>
    </div>
    <span class="isf-speech">
      "যে ব্যক্তি ফজরের নামাজ পড়ে,<br>
      সে আল্লাহর জিম্মায় থাকে।"
    </span>
    <span class="isf-source">— সহিহ মুসলিম</span>

    <div class="isf-top-orn" style="margin-top:14px;margin-bottom:12px;">
      <div class="isf-line"></div>
      <div class="isf-diamond"></div>
      <div class="isf-line"></div>
    </div>
    <span class="isf-speech">
      "ইফতারের সময় রোজাদারের দোয়া<br>
      কখনো বৃথা যায় না।"
    </span>
    <span class="isf-source">— তিরমিজি শরিফ</span>

    <div class="isf-top-orn" style="margin-top:14px;margin-bottom:0;">
      <div class="isf-line"></div>
      <div class="isf-diamond"></div>
      <div class="isf-line"></div>
    </div>
  </div>
</div>
<div class="mobile-save-bar" id="mobile-bar" style="display:none;">
  <button class="mobile-save-btn" onclick="save()">✦ &nbsp; সংরক্ষণ করুন &nbsp; ✦</button>
</div>

<!-- ══════════════════════════════════════════
     FIREBASE — Realtime Database (v12.9.0)
     ⚠️  DO NOT MODIFY THIS BLOCK
══════════════════════════════════════════ -->
<script type="module">
import { initializeApp }                                          from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAnalytics }                                           from "https://www.gstatic.com/firebasejs/12.9.0/firebase-analytics.js";
import { getDatabase, ref, set, get, onValue, runTransaction }   from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

/* ── Firebase project config ── */
const firebaseConfig = {
  apiKey:            "AIzaSyBhG3iYcvfBgNpg1_Ve24AYEPxtovzmdKQ",
  authDomain:        "mosque-times-35917.firebaseapp.com",
  databaseURL:       "https://mosque-times-35917-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId:         "mosque-times-35917",
  storageBucket:     "mosque-times-35917.firebasestorage.app",
  messagingSenderId: "665723133778",
  appId:             "1:665723133778:web:af805cdf1ce39d61f1648b",
  measurementId:     "G-VBLRRLY613"
};

/* ── Initialise app & services ── */
const app       = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const db        = getDatabase(app);

/* ── Prayer time keys ── */
const KEYS = ["sehri","fajr","zuhr","asr","iftar","maghrib","isha"];

/* ── Fallback data (shown only if DB has no data yet) ── */
const FALLBACK = {
  mosqueName: "আল-নূর জামে মসজিদ",
  sehri:   "৪:২৮ AM",
  fajr:    "৪:৪৮ AM",
  zuhr:    "১২:১৫ PM",
  asr:     "৪:৩০ PM",
  iftar:   "৬:৪২ PM",
  maghrib: "৬:৪৭ PM",
  isha:    "৮:১৫ PM"
};

/* ── Update DOM with latest data ── */
function apply(data) {
  const d  = data || FALLBACK;
  const nm = d.mosqueName || FALLBACK.mosqueName;

  /* Home-screen mosque name */
  document.getElementById("mosque-name").textContent = nm;
  /* Admin panel pre-fill */
  document.getElementById("i-mosque").value = nm;

  /* Prayer times on home + admin inputs */
  KEYS.forEach(k => {
    document.getElementById("t-" + k).textContent = d[k] || "— : —";
    document.getElementById("i-" + k).value       = d[k] || "";
  });
}

/* ── Status indicator ── */
function setStatus(state) {
  const dot = document.getElementById("status-dot");
  const txt = document.getElementById("status-txt");
  dot.className  = "live-dot " + state;
  txt.textContent = state === "live"
    ? "রিয়েল-টাইম সংযুক্ত"
    : "সংযোগ হচ্ছে...";
}

/* ── Listen to Firebase in real-time (onValue fires instantly on any change) ── */
setStatus("connecting");
onValue(
  ref(db, "prayerTimes"),
  (snapshot) => {
    setStatus("live");
    apply(snapshot.val());
  },
  (error) => {
    console.error("Firebase read error:", error);
    setStatus("connecting");
    apply(FALLBACK);
  }
);

/* ── Save handler: writes to DB → onValue fires → home screen updates instantly ── */
window.save = async function () {
  const data = {
    mosqueName: document.getElementById("i-mosque").value.trim() || FALLBACK.mosqueName
  };
  KEYS.forEach(k => {
    data[k] = document.getElementById("i-" + k).value.trim();
  });

  try {
    await set(ref(db, "prayerTimes"), data);
    window.celebrate();
  } catch (err) {
    console.error("Firebase write error:", err);
    apply(data);
    window.celebrate();
  }
};

/* ── Visitor counter ──
   Uses a session flag so refreshing the page doesn't double-count.
   Each unique session (tab open) counts as 1 visitor. ── */
(async function trackVisitor(){
  const BN = n => String(n).replace(/\d/g, d => "০১২৩৪৫৬৭৮৯"[d]);
  const el  = document.getElementById("visitor-count");

  /* Listen for live updates (shows count to everyone in real time) */
  onValue(ref(db,"visitorCount"), snap => {
    const v = snap.val() || 0;
    if(el) el.textContent = BN(v);
  });

  /* Only increment once per browser session */
  if(!sessionStorage.getItem("_vCounted")){
    sessionStorage.setItem("_vCounted","1");
    try{
      await runTransaction(ref(db,"visitorCount"), cur => (cur||0)+1);
    } catch(e){ console.warn("Visitor count error:",e); }
  }
})();
</script>

<!-- ══════════════════════════════════════════
     UI SCRIPTS
══════════════════════════════════════════ -->
<script>
/* ═══════════════════════════════════════
   TAB + SAVE BAR
═══════════════════════════════════════ */
function sw(id){
  ["s","a"].forEach(x=>{
    document.getElementById("tb-"+x).classList.toggle("on",x===id);
    document.getElementById("tb-"+x).setAttribute("aria-selected",x===id?"true":"false");
    document.getElementById("pn-"+x).classList.toggle("on",x===id);
  });
  const bar=document.getElementById("mobile-bar");
  if(bar) bar.style.display=(id==="a")?"block":"none";
}
window._redirectHome = ()=>{ setTimeout(()=>sw("s"),1600); };
window._flashTimes   = ()=>{
  document.querySelectorAll(".p-time").forEach(el=>{
    el.classList.remove("updated"); void el.offsetWidth;
    el.classList.add("updated");
    setTimeout(()=>el.classList.remove("updated"),700);
  });
};
window.celebrate = function(){
  const t=document.getElementById("toast");
  t.classList.add("show"); setTimeout(()=>t.classList.remove("show"),3400);
  burst(); window._flashTimes(); window._redirectHome();
  /* re-detect active waqt after data refreshes */
  setTimeout(markActiveWaqt, 200);
};

/* ═══════════════════════════════════════
   ACTIVE WAQT DETECTION
   Reads .p-time text → compares with clock
   Marks correct .p-row with class .now
═══════════════════════════════════════ */
const WAQT_KEYS = ["sehri","fajr","zuhr","asr","iftar","maghrib","isha"];

/* Convert "৬:৪৫ PM" or "6:45 PM" → minutes since midnight */
function toMinutes(str){
  if(!str||str.includes("—")) return null;
  /* Bangla digits → ASCII */
  const s = str.replace(/[০-৯]/g, d=>"০১২৩৪৫৬৭৮৯".indexOf(d).toString());
  const m = s.match(/(\d{1,2}):(\d{2})\s*(AM|PM)/i);
  if(!m) return null;
  let h=parseInt(m[1]), mn=parseInt(m[2]);
  const pm=/pm/i.test(m[3]);
  if(pm&&h!==12) h+=12;
  if(!pm&&h===12) h=0;
  return h*60+mn;
}

let _emberTimer=null;

function markActiveWaqt(){
  const now=new Date();
  const cur=now.getHours()*60+now.getMinutes();

  /* Collect valid time entries */
  const entries=WAQT_KEYS.map(k=>{
    const el=document.getElementById("t-"+k);
    return{k, t: el?toMinutes(el.textContent):null};
  }).filter(e=>e.t!==null);

  if(!entries.length) return;

  /* Active = last entry whose start ≤ now (wraps at midnight to last) */
  let activeKey=entries[0].k;
  for(const e of entries){ if(cur>=e.t) activeKey=e.k; }

  /* Apply / remove classes */
  document.querySelectorAll(".p-row").forEach(row=>{
    const key=row.dataset.key;
    const isNow=(key===activeKey);

    if(isNow&&!row.classList.contains("now")){
      row.classList.add("now");

      /* Label */
      if(!row.querySelector(".waqt-lbl")){
        const l=document.createElement("span");
        l.className="waqt-lbl"; l.textContent="ওয়াক্ত চলছে";
        row.appendChild(l);
      }
      /* 2nd ping ring inside badge */
      const badge=row.querySelector(".p-badge");
      if(badge&&!badge.querySelector(".now-ping2")){
        const p=document.createElement("div");
        p.className="now-ping2"; badge.appendChild(p);
      }
    } else if(!isNow){
      row.classList.remove("now");
      row.querySelector(".waqt-lbl")?.remove();
      row.querySelector(".now-ping2")?.remove();
    }
  });

  /* Continuous embers on active card */
  clearInterval(_emberTimer);
  const activeRow=document.querySelector(`.p-row[data-key="${activeKey}"]`);
  if(activeRow && !('ontouchstart' in window)){
    _emberTimer=setInterval(()=>spawnEmbers(activeRow),1000);
  }
}

function spawnEmbers(row){
  const cols=["#fdeea0","#f5d870","#fff8d0","#e8bf50","#ffecb3","#fffde7","#ffffff"];
  const isMob='ontouchstart' in window;
  const n=isMob ? 1+Math.floor(Math.random()*2) : 2+Math.floor(Math.random()*3);
  for(let i=0;i<n;i++){
    const e=document.createElement("div"); e.className="ember";
    const sz=3+Math.random()*7;
    const ex=(Math.random()-.5)*90;
    const c=cols[~~(Math.random()*cols.length)];
    e.style.cssText=
      `width:${sz}px;height:${sz}px;background:${c};`+
      `left:${12+Math.random()*76}%;bottom:${58+Math.random()*28}%;`+
      `--ex:${ex}px;`+
      `animation-duration:${.7+Math.random()*.9}s;`+
      `animation-delay:${Math.random()*.25}s;`+
      `box-shadow:0 0 ${sz*2}px ${c};`;
    row.appendChild(e);
    setTimeout(()=>e.remove(),1500);
  }
}

/* Run on load, then every minute */
markActiveWaqt();
setInterval(markActiveWaqt, 60000);

/* Re-detect whenever DOM times change (Firebase listener triggers this) */
const _timeObs=new MutationObserver(()=>{ setTimeout(markActiveWaqt,100); });
WAQT_KEYS.forEach(k=>{
  const el=document.getElementById("t-"+k);
  if(el) _timeObs.observe(el,{childList:true,characterData:true,subtree:true});
});

/* ═══════════════════════════════════════
   SPARK DUST ONLY — ultra-light, mobile safe
═══════════════════════════════════════ */
(function spawnAllFloaters(){
  const D=document.getElementById("dust");
  if(!D) return;
  const mob = ('ontouchstart' in window) || window.innerWidth <= 600;
  /* Only spawn tiny spark dots — pure opacity animation, zero GPU cost */
  const n = mob ? 18 : 40;
  for(let i=0;i<n;i++){
    const m=document.createElement("div"); m.className="mote-star";
    const sz=Math.random()<.3?3:2;
    const dur=3+Math.random()*7;
    m.style.cssText=
      `width:${sz}px;height:${sz}px;`+
      `left:${Math.random()*100}%;`+
      `top:${Math.random()*100}%;`+
      `animation-duration:${dur}s;`+
      `animation-delay:-${Math.random()*dur}s;`+
      `opacity:${.3+Math.random()*.6};`;
    D.appendChild(m);
  }
})();

/* ═══════════════════════════════════════
   TOUCH RIPPLE
═══════════════════════════════════════ */
document.querySelectorAll(".p-row").forEach(row=>{
  row.addEventListener("pointerdown",function(e){
    const rect=row.getBoundingClientRect();
    const size=Math.max(rect.width,rect.height)*.65;
    const x=e.clientX-rect.left-size/2, y=e.clientY-rect.top-size/2;
    const r=document.createElement("div"); r.className="ripple-ring";
    r.style.cssText=`width:${size}px;height:${size}px;left:${x}px;top:${y}px;`;
    row.appendChild(r); setTimeout(()=>r.remove(),620);
  },{passive:true});
});

/* ═══════════════════════════════════════
   BANGLA & HIJRI DATES
═══════════════════════════════════════ */
const BN=n=>String(n).replace(/\d/g,d=>"০১২৩৪৫৬৭৮৯"[d]);
const BNM=["জানুয়ারি","ফেব্রুয়ারি","মার্চ","এপ্রিল","মে","জুন","জুলাই","আগস্ট","সেপ্টেম্বর","অক্টোবর","নভেম্বর","ডিসেম্বর"];
const BND=["রবিবার","সোমবার","মঙ্গলবার","বুধবার","বৃহস্পতিবার","শুক্রবার","শনিবার"];
const HJM=["مُحَرَّم","صَفَر","رَبِيع الأوَّل","رَبِيع الثَّانِي","جُمَادَى الأولَى","جُمَادَى الثَّانِيَة","رَجَب","شَعْبَان","رَمَضَان","شَوَّال","ذُو الْقَعْدَة","ذُو الْحِجَّة"];
function toHijri(Y,M,D){
  let jd=Math.floor((14-M)/12),y=Y+4800-jd,m=M+12*jd-3;
  let jdn=D+Math.floor((153*m+2)/5)+365*y+Math.floor(y/4)-Math.floor(y/100)+Math.floor(y/400)-32045;
  let l=jdn-1948440+10632,n=Math.floor((l-1)/10631);l=l-10631*n+354;
  let j=Math.floor((10985-l)/5316)*Math.floor((50*l)/17719)+Math.floor(l/5670)*Math.floor((43*l)/15238);
  l=l-Math.floor((30-j)/15)*Math.floor((17719*j)/50)-Math.floor(j/16)*Math.floor((15238*j)/43)+29;
  let hm=Math.floor((24*l)/709);
  return{d:l-Math.floor(709*hm/24),m:hm,y:30*n+j-30};
}
function refreshDates(){
  const now=new Date(),d=now.getDate(),mo=now.getMonth(),y=now.getFullYear();
  document.getElementById("d-eng").textContent=BND[now.getDay()]+"، "+BN(d)+" "+BNM[mo]+" "+BN(y);
  const h=toHijri(y,mo+1,d);
  document.getElementById("d-hij").textContent=h.d+" "+HJM[h.m-1]+" "+BN(h.y);
}
refreshDates();
setTimeout(()=>{refreshDates();setInterval(refreshDates,86400000);},new Date().setHours(24,0,0,0)-Date.now());

/* ═══════════════════════════════════════
   IFTAR / SEHRI COUNTDOWN TIMER
   Real-time: counts from actual current moment
   Updates every 250ms for smooth seconds
═══════════════════════════════════════ */
(function initCountdown(){
  const pad  = n => String(n).padStart(2,"0");
  const BN2  = s => String(s).replace(/\d/g, d => "০১২৩৪৫৬৭৮৯"[d]);

  /* Parse "৬:৪৫ PM" or "6:45 PM" → minutes since midnight */
  function parseTimeTxt(txt){
    if(!txt) return null;
    const s = txt.replace(/[০-৯]/g, d=>"০১২৩৪৫৬৭৮৯".indexOf(d).toString());
    const m = s.match(/(\d{1,2}):(\d{2})\s*(AM|PM)/i);
    if(!m) return null;
    let h=parseInt(m[1]), mn=parseInt(m[2]);
    if(/pm/i.test(m[3])&&h!==12) h+=12;
    if(/am/i.test(m[3])&&h===12) h=0;
    return h*60+mn; /* minutes since midnight */
  }

  /* Get a fresh Date object set to today at the given minute-of-day.
     If that moment is already past, advance to tomorrow. */
  function getTarget(key){
    const el = document.getElementById("t-"+key);
    if(!el) return null;
    const mins = parseTimeTxt(el.textContent||"");
    if(mins===null) return null;
    const now  = new Date();
    const target = new Date(now);
    target.setHours(Math.floor(mins/60), mins%60, 0, 0);
    if(target <= now) target.setDate(target.getDate()+1);
    return target;
  }

  function render(prefix, target){
    const hEl = document.getElementById("cdp-"+prefix+"-h");
    const mEl = document.getElementById("cdp-"+prefix+"-m");
    const sEl = document.getElementById("cdp-"+prefix+"-s");
    const lEl = document.getElementById("cdp-"+prefix+"-lbl");
    if(!hEl||!mEl||!sEl) return;

    if(!target){
      hEl.textContent=mEl.textContent=sEl.textContent="--";
      if(lEl) lEl.textContent="সময় পাওয়া যায়নি";
      return;
    }

    /* Use real wall-clock diff from this exact moment */
    const diffMs = target.getTime() - Date.now();

    if(diffMs <= 0){
      hEl.textContent=mEl.textContent=sEl.textContent=BN2("00");
      if(lEl) lEl.textContent=(prefix==="iftar")?"🌇 ইফতারের সময় হয়েছে!":"🌙 সেহরির সময় শেষ!";
      return;
    }

    const totalSec = Math.floor(diffMs/1000);
    const hh = Math.floor(totalSec/3600);
    const mm = Math.floor((totalSec%3600)/60);
    const ss = totalSec%60;

    hEl.textContent = BN2(pad(hh));
    mEl.textContent = BN2(pad(mm));
    sEl.textContent = BN2(pad(ss));

    if(lEl){
      if(hh>0)      lEl.textContent = BN2(hh)+" ঘণ্টা "+BN2(mm)+" মিনিট বাকি";
      else if(mm>0) lEl.textContent = BN2(mm)+" মিনিট "+BN2(ss)+" সেকেন্ড বাকি";
      else          lEl.textContent = "মাত্র "+BN2(ss)+" সেকেন্ড বাকি!";
    }
  }

  function tickAll(){
    render("iftar", getTarget("iftar"));
    render("sehri", getTarget("sehri"));
  }

  /* Tick immediately, then align to exact second boundary */
  tickAll();
  const msToNextSec = 1000 - (Date.now()%1000);
  setTimeout(()=>{
    tickAll();
    setInterval(tickAll, 1000);
  }, msToNextSec);

  /* Re-tick when Firebase updates prayer times */
  const obs = new MutationObserver(()=>{ tickAll(); });
  ["t-iftar","t-sehri"].forEach(id=>{
    const el=document.getElementById(id);
    if(el) obs.observe(el,{childList:true,characterData:true,subtree:true});
  });
})();

/* ═══════════════════════════════════════
   CELEBRATION BURST
═══════════════════════════════════════ */
function burst(){
  const C=document.getElementById("pcl");
  const cols=["#fdeea0","#f5d870","#e8bf50","#fff8d0","#d4a832","#b9f6ca","#c8f5e8","#ffffff","#ffd54f","#ffecb3","#ffe082"];
  const shapes=["50%","4px","50%","2px","50%","6px","50%"];
  for(let i=0;i<110;i++){
    const p=document.createElement("div"); p.className="pc";
    const sz=3+Math.random()*15, c=cols[~~(Math.random()*cols.length)], sh=shapes[~~(Math.random()*shapes.length)];
    p.style.cssText=`width:${sz}px;height:${sz}px;background:${c};border-radius:${sh};`+
      `left:${2+Math.random()*96}%;bottom:${2+Math.random()*58}%;`+
      `animation-delay:${Math.random()*.85}s;animation-duration:${1.3+Math.random()*1.2}s;`+
      `box-shadow:0 0 ${sz*2.2}px ${c};`;
    C.appendChild(p); setTimeout(()=>p.remove(),3400);
  }
}
</script>
</body>
</html>
